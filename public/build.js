(()=>{"use strict";Vue.component("cart",{template:'<div>\n                <button class="cart-button" @click="openCartHandler" type="button">Корзина</button>\n                <div v-if="isVisibleCart" v-on:click="removeHandler">\n                <slot></slot>\n                </div>\n            </div>',data:()=>({isVisibleCart:!1}),methods:{openCartHandler(){this.isVisibleCart=!this.isVisibleCart},removeHandler(t){this.$emit("remove",t)}}}),Vue.component("goods_item",{template:'\n            <div :data-id="id" class="goods_item">\n                \x3c!--<div class="card-img">\n                    <img src="" class="rounded mx-auto d-block">\n                </div>--\x3e\n                <h5 class="card-title">{{ title }}</h5>\n                <p class="card-text text-price">{{ price }}</p> \n            </div>',props:["title","price","id"]}),Vue.component("search",{template:'<div>\n                    <input id="search" v-model="search">\n                    <button v-on:click="searchHandler">SEARCH</button>\n                </div>',data:()=>({search:""}),methods:{searchHandler(){this.$emit("search",this.search)}}}),new Vue({el:"#app",data:{cart:[],goods:[],filtredGoods:[],search:"",isLoaded:!1},methods:{addToCartHandler(t){const e=t.target.closest(".goods_item").dataset.id,s=this.goods.find((t=>t.id==e));fetch("/cart",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),this.cart.push(s)},removeFromCartHandler(t){const e=t.target.closest(".goods_item").dataset.id,s=this.cart.findIndex((t=>t.id==e));this.cart.splice(s,1)},searchHandler(t){""===t&&(this.filtredGoods=this.goods);const e=new RegExp(t,"gi");this.filtredGoods=this.goods.filter((t=>e.test(t.title)))}},mounted(){fetch("/data").then((t=>t.json())).then((t=>{this.goods=t,this.filtredGoods=t,this.isLoaded=!0})).catch((t=>{console.log(t)})),fetch("/cart").then((t=>t.json())).then((t=>{this.cart=t})).catch((t=>{console.log(t)}))}})})();